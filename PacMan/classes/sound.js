class SoundManagerError extends Error{constructor(e){super(e),this.name="SoundManagerError"}}class SoundManager{audioCount=50;audioHolder=[];lastPlayed=[];protectedAudio=[];get protectedAudioCount(){return this.protectedAudio.length}get lastPlayedCount(){return this.lastPlayed.length}get maxAudioUsed(){return this.protectedAudioCount+this.lastPlayedCount}get audioPlayingCount(){return this.audioHolder.filter(e=>!e.paused).length}constructor(e=50){this.audioCount=e;for(var t=0;t<e;t++)this.audioHolder.push(new AudioContainer(this,new Audio))}GetUnusedSource(e=!1){var t=this.audioHolder.find(e=>!e.playing&&!this.protectedAudio.includes(e));if(t)-1!=this.lastPlayed.indexOf(t)&&this.lastPlayed.splice(this.lastPlayed.indexOf(t),1);else{if(0==this.lastPlayedCount)throw new SoundManagerError("Unable to find an Audio which is not protected.");t=this.lastPlayed.shift()}return e?this.protectedAudio.push(t):this.lastPlayed.push(t),(t.playing||t.paused)&&t.stop(),t}removeProtectedAudio(e){return!!this.protectedAudio.includes(e)&&(this.protectedAudio.splice(this.protectedAudio.indexOf(e),1),(e.playing||e.paused)&&e.stop(),!0)}isProtected(e){if(!this.audioHolder.includes(e))throw new SoundManagerError("Audio not in SoundManager list");return this.protectedAudio.includes(e)}}class AudioContainer{constructor(e,t){this.sManager=e,this.audio=t,this.playing=!1,this.paused=!1,this.loopCallback=null}get volume(){return this.audio.volume}set volume(e){this.audio.volume=e}get src(){return this.audio.src}set src(e){this.audio.src=e}get isProtected(){return this.sManager.isProtected(this.audio)}get duration(){return this.audio.duration}get elapsedTime(){return this.audio.currentTime}set elapsedTime(e){this.audio.currentTime=e}get elapsed(){return this.elapsedTime/this.duration}set elapsed(e){this.elapsedTime=e*this.duration}get remainingTime(){return this.duration-this.elapsedTime}get remaining(){return 1-this.elapsed}play(e=null,t=()=>{},i=!1){if(this.playing)throw new SoundManagerError("Already Playing!");if(this.paused&&!i)throw new SoundManagerError("Audio Paused! Use resume() To Continue Playback");e&&(this.src=e);var s=e=>{this.playing=!1,e.endedByStopFunction||t(),this.audio.removeEventListener("ended",s)};return this.audio.play(),i||this.audio.addEventListener("ended",s),this.playing=!0,this.paused=!1,this}loop(e=null,t=()=>{},i=!1){if(this.playing)throw new SoundManagerError("Already Playing!");if(this.paused&&!i)throw new SoundManagerError("Audio Paused! Use resume() To Continue Playback");e&&(this.src=e);var s=()=>{var e=!1,i=()=>{e=!0,this.audio.removeEventListener("paused",i),this.audio.removeEventListener("play",s)};this.audio.addEventListener("paused",i),setTimeout(()=>{if(!e){t();var i=setInterval(()=>{if(e)return clearInterval(i);t()},1e3*this.duration)}},1e3*this.remainingTime)},a=()=>{this.playing=!1,this.loopCallback=null,this.audio.removeEventListener("ended",a)};return i||this.audio.addEventListener("ended",a),this.audio.addEventListener("play",s),this.audio.loop=!0,this.loopCallback=t,this.audio.play(),this.playing=!0,this.paused=!1,this}pause(){if(this.paused||!this.playing)throw new SoundManagerError("Nothing To Pause!");return this.audio.pause(),this.paused=!0,this.playing=!1,this.audio.dispatchEvent(new Event("paused")),this}resume(){if(!this.paused)throw new SoundManagerError("Audio Not Paused!");return this.loopCallback?this.loop(null,this.loopCallback,!0):this.play(null,()=>{},!0)}stop(){if(!this.playing&&!this.paused)throw new SoundManagerError("Nothing Playing!");this.audio.pause(),this.audio.loop=!1,this.elapsed=0,this.paused||this.audio.dispatchEvent(new Event("paused"));var e=new Event("ended");return e.endedByStopFunction=!0,this.audio.dispatchEvent(e),this.paused=!1,this}}